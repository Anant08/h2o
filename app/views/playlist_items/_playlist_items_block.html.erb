<table class="core_table">
  <thead>
    <tr class="table_heading ">
      <th>Item Title</th>
      <th>Description</th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody class="sortable">
    <% @playlist.playlist_items.each do |item| %>
      <tr id="playlist_item_<%= item.id%> " class="sortable_item">
        <td>
          <div class="item-display-title"><%=h item.resource_item.name %></div>
          <div class="item-preview"><%= item.resource_item.preview %></div>
          <div class="item-url"><a href='<%= item.resource_item.url %>' target="_blank"><%= truncate(item.resource_item.url, :length => 40, :omission => "...(more)") %></a></div>
        </td>
        <td>
          <div class="item-description"><%= PlaylistItem.format_content(item.resource_item.description) %></div>
        </td>
        <td width="10%">
          <% if current_user && @playlist_admin || @my_playlist %>
            <%= link_to 'edit', url_for(:controller => item.resource_item_type.tableize, :action => 'edit', :id => item.resource_item, :container_id => item.playlist), :class => 'button edit-playlist-item' %>
          <%  end %>
          <% if current_user && @playlist_admin || @my_playlist %>
            <%= link_to('Delete', url_for(:controller => item.resource_item_type.tableize, :action => 'destroy', :id => item.resource_item), :class => 'button delete-playlist-item' ) %>
          <% end %>
        </td>
        <td width="10%">
          <% if current_user && @playlist_admin || @my_playlist %>
            <div class="item_drag_handle button">Reorder</div>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= javascript_tag %Q|
jQuery(document).ready(function(){
    jQuery('.item_drag_handle').button({icons: {primary: 'ui-icon-arrowthick-2-n-s'}});

    jQuery(".sortable").sortable({
        handle: '.item_drag_handle',
        axis: 'y',
        helper: sortableCellHelper,
        update: function(event, ui) {
            var container_id = jQuery('#container_id').text();
            var playlist_order = jQuery(".sortable").sortable("serialize");
            jQuery.ajax({
                type: "post",
                dataType: 'json',
                url: '/playlists/' + container_id + '/position_update',
                data: {
                    playlist_order: playlist_order
                }
            });
        }
        }).disableSelection();
   });
| %>
