<table class="core_table">
  <thead>
    <tr class="table_heading ">
      <th>Item Title</th>
      <th>Description</th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody class="sortable">
    <% @playlist.playlist_items.each do |item| %>
      <tr id="playlist_item_<%= item.id%> " class="sortable_item">
        <td>
          <div class="item-display-title"><%= item.resource_item.output_text %></div>
          <div class="item-preview"><%= item.resource_item.preview %></div>
          <div class="item-url"><a href='<%= item.resource_item.url %>' target="_blank"><%= truncate(item.resource_item.url, 40, "...(more)") %></a></div>
        </td>
        <td>
          <div class="item-description"><%= PlaylistItem.format_content(item.resource_item.description) %></div>
        </td>
        <td width="10%">
          <% if current_user && (item.resource_item.admin? || item.resource_item.owner?) %>
          <button id="button-item-edit-<%= item.id %>" name="button-item-edit" class="ui-button ui-state-default ui-corner-all">
            <%= image_tag "/images/icons/application_form_edit.png" %>
          </button>
          <%  end %>
          <% if current_user && (item.admin? || item.owner?) %>
          <button id="button-item-delete-<%= item.id %>" name="button-item-delete" class="ui-button ui-state-default ui-corner-all">
            <%= image_tag "/images/icons/application_form_delete.png" %>
          </button>
          <% end %>
        </td>
        <td width="10%">
          <% if current_user && (item.admin? || item.owner?) %>
            <div class="item_drag_handle button">Reorder</div>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= javascript_tag %Q|
jQuery(document).ready(function(){
    jQuery('.item_drag_handle').button({icons: {primary: 'ui-icon-arrowthick-2-n-s'}});

    jQuery(".sortable").sortable({
        handle: '.item_drag_handle',
        axis: 'y',
        helper: sortableCellHelper,
        update: function(event, ui) {
            var container_id = jQuery('#container_id').text();
            var playlist_order = jQuery(".sortable").sortable("serialize");
            jQuery.ajax({
                type: "post",
                dataType: 'json',
                url: '/playlists/' + container_id + '/position_update',
                data: {
                    playlist_order: playlist_order
                }
            });
        }
        }).disableSelection();
   });
| %>
