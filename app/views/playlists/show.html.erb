<%= render :partial => 'shared/second_nav', :locals => { :nav_id => 'playlists-logo',
  :url => playlists_path,
  :right_search => 'playlists/nav_search' } %>

<div id="playlist" class="singleitem" data-itemid="<%= @playlist.id %>">
	<hgroup class="description">
		<h2><%= @playlist.name %></h2>
		<aside class="toolbar">
			<ul>
				<li class="requires_logged_in"><%= link_to "Remix Playlist", copy_playlist_path(@playlist), :class => "link-remix remix-action" %></li>
				<li class="requires_logged_in"><%= link_to "Bookmark This Playlist", '#', :class => "link-bookmark bookmark-action" %></li>
				<li><%= link_to 'Print', playlist_path(@playlist, :format => 'pdf'), :class => 'link-print' %></li>
			</ul>
		</aside>
		<aside class="buttons">
			<ul>
        <li class="btn-li afterload">
          <a href="#" class="btn-a" id="fonts">
            <span>Aa</span>
          </a>
					<div class="popup font-size-popup">
            <select id="font-size">
              <option value="10">small</option>
              <option value="13">medium</option>
              <option value="16">large</option>
              <option value="19">extra-large</option>
            </select>
          </div>
        </li>
    	  <li class="btn-li requires_edit">
					<%= link_to 'ADD ITEM +', new_playlist_item_path, :class => 'btn-a new-playlist-item-control' %>
				</li>
			</ul>
		</aside>
		<div class="cl"></div>
	</hgroup>
	<div class="details">
		<% cache "playlist-#{@playlist.id}-tags" do -%>
		<div class="tags">
			<ul>
				<% @playlist.tags.each do |tag| -%>
				<li><%= link_to tag.name, playlist_tag_path(CGI.escape(tag.name)) %></li>
				<% end -%>
			</ul>
		</div>
		<% end -%>
		<h5>
			<%= @playlist.created_at.to_s(:simpledatetime) %>
			by <a href="#"><%= raw @playlist.owners.collect { |u| link_to(u.login, user_path(u)) }.join(', ') %></a>
			<a href="#" id="playlist-stats" title="test"><strong>PLAYLIST STATS</strong></a>
			<div class="popup" id="playlist-stats-popup">
        <h5>Playlists that contain this one:</h3>
        <% @parents.each do |playlist| -%>
          <%= playlist.created_at.to_s(:simpledatetime) %>
          <%= link_to playlist.name, playlist %> by <%= raw playlist.owners.collect { |u| link_to(u.login, user_path(u)) }.join(', ') %><br /><br />
        <% end -%>
			</div>
		</h5>
		<% if false -%>
		<div class="influence"></div>
		<% end -%>
		<div class="cl"></div>
		<% if !@playlist.description.nil? -%>
		<% if @playlist.description.length > 500 -%>
			<div id="description_less">
				<%= @playlist.description[0..500] %>... <a href="#" class="link-more">MORE</a>
			</div>
			<div id="description_more">
				<%= @playlist.description %> <a href="#" class="link-less">LESS</a>
				<%= link_to "EDIT", edit_playlist_path(@playlist), :class => "edit-action requires_edit" %>
			</div>
		<% else -%>
			<div id="description">
				<%= @playlist.description %>
				<%= link_to "EDIT", edit_playlist_path(@playlist), :class => "edit-action requires_edit" %>
			</div>
		<% end -%>
		<% else -%>
			<p>
				<%= link_to "EDIT", edit_playlist_path(@playlist), :class => "edit-action requires_edit" %>
			</p>
		<% end -%>
	</div>
	<%= render :partial => 'playlist_items/playlist_items_block', :locals => {:playlist => @playlist} %>
</div>
<script type="text/javascript">
var container_id = <%= @playlist.id %>;
var editability_path = "<%= access_level_playlist_path(@playlist) %>"; 
</script>

<%= render :partial => "shared/popup", :locals => { :type => "playlist" } %>
